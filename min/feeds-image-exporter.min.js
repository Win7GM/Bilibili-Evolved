(()=>(a,e)=>{(async()=>{const{forEachFeedsCard:a,addMenuItem:n}=await e.importAsync("feeds-apis");const t=a=>{n(a,{className:"image-export",text:"导出图片",action:async()=>{const n=[];dqa(a.element,".main-content img, .main-content .img-content").forEach((a=>{const e=retrieveImageUrl(a);if(e){n.push(e)}}));if(n.length===0){Toast.info("此条动态没有检测到任何图片.","动态图片导出");return}const{DownloadPackage:t}=await e.importAsync("download-package");const o=await Promise.all(n.map((({url:a})=>Ajax.getBlob(a))));const i=new t;o.forEach(((e,t)=>i.add(`${a.username}-${a.id}-${t}${n[t].extension}`,e)));await i.emit(`${a.username}-${a.id}.zip`)}})};a({added:t})})()})();