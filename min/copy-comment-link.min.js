(()=>(t,e)=>{(async()=>{const{forEachCommentItem:t}=await e.importAsync("comment-apis");const i=["https://t.bilibili.com","https://space.bilibili.com","https://live.bilibli.com"];const n=t=>{if(document.URL.match(/\/\/t\.bilibili\.com\/(\d+)/)){return""}if(i.every((t=>!document.URL.includes(t)))){return""}let e=t;while(e!==null&&e!==document.body){if(e.hasAttribute("data-did")){return`https://t.bilibili.com/${e.getAttribute("data-did")}`}e=e.parentElement}return""};const l=t=>{const e=t=>{t.forEach((t=>{const e=dq(t.element,".opera-list ul");if(!e||dq(e,".copy-link")){return}const i=document.createElement("li");i.classList.add("copy-link");i.textContent="复制链接";i.addEventListener("click",(()=>{const e=n(t.element)||document.URL.replace(/#.+$/,"");GM_setClipboard(`${e}#reply${t.id}`,{mimetype:"text/plain"});console.log("[Copy Comment Link]",`${e}#reply${t.id}`)}));e.appendChild(i)}))};e([t,...t.replies]);t.onRepliesUpdate=t=>e(t)};t({added:l})})()})();