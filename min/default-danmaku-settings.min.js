(()=>(e,t)=>{async function i(e,t){const i=await SpinQuery.select((()=>document.querySelector(e)));if(!i){return}i.checked=t;raiseEvent(i,"change")}Observer.videoChange((()=>{if(!e.enableDanmaku){i(".bilibili-player-video-danmaku-switch>input",false)}if(e.rememberDanmakuSettings){const i={subtitlesPreserve:".bilibili-player-video-danmaku-setting-left-preventshade input",smartMask:".bilibili-player-video-danmaku-setting-left-danmaku-mask input"};async function n(){const n=await SpinQuery.select((()=>document.querySelector(".bilibili-player-video-danmaku-setting")));if(!n){return}await loadLazyPanel(".bilibili-player-video-danmaku-setting");setTimeout((()=>t.removeStyle("defaultDanmakuSettingsStyle")),300);for(const[t,n]of Object.entries(e.danmakuSettings)){const e=await SpinQuery.select((()=>document.querySelector(i[t])));if(e!==null&&e.checked!==undefined&&e.checked!==n){e.click()}}}async function a(){for(const t in e.danmakuSettings){const n=await SpinQuery.select((()=>document.querySelector(i[t])));if(!n){return}n.addEventListener("click",(()=>{e.danmakuSettings=Object.assign(e.danmakuSettings,{[t]:n.checked})}))}}n();a()}}))})();